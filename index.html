<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MatchFlix</title>
</head>
<body>
    <form>
        <input type="text" name="user_name" id="userName">
        <input type="submit" value="Entrar" onclick="enviarDado()">
    </form>

    <button onclick="carregarRecomendations()">Carregar Recomendações</button>
    <div class="areaRecomendations"></div>

    <script>
        let url = 'http://127.0.0.1:8000/';
        let areaRecomendations = document.querySelector('.areaRecomendations')


        function enviarDado(){
            let userName = document.querySelector('#userName').value;
            let data = {
                user_name: userName
            }

            fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data), })
                .then(response => response.json())
                .then(data => { console.log('Resposta da API:', data); })
                .catch(error => { console.error('Erro:', error);
            });
        }

        function carregarRecomendations(){
            fetch(url, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }})
                .then(response => response.json())
                .then(data => {
                    console.log('Resposta da API:', data.recomendations);
                    const recomendations = data.recomendations;
                    recomendations.forEach(element => {
                    const item = document.createElement('p');
                    let porcetagem = (element[0] * 100)/5
                    item.textContent = `${element[1]}: ${porcetagem.toFixed(0)}%`;
                    areaRecomendations.appendChild(item);
            });
                })
                .catch(error => { console.error('Erro:', error);
            });
        }
    </script>
</body>
</html>